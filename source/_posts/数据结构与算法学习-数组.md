---
title: 数据结构与算法学习-数组
date: 2019-02-15 16:43:24
tags:
- 数据结构
- 算法
- 线性表
categories:
- 数据结构
- 算法
---


## 前言

这一篇笔记主要记录总结了`线性表`数据结构中的`数组`和`链表`概念以及`相关的算法`。


## 名词解释

### 1. 线性表（Linear List）

`线性表`是数据排成像`一条线一样的结构`，每个线性表上的数据最多有向前和向后两个方向。除了`数组`外，`链表、队列、栈`也是`线性表`数据结构。

<!--more-->

![](http://liangjinggege.com/linearList.jpg)


### 2. 非线性表

和线性表相对立，数据之间`不是简单的前后关系`，这样的结构称为`非线性表`，如`图、树、堆`等数据结构。

![](http://liangjinggege.com/nonLinearList.jpg)

## 数组

数组是一种`线性表`数据结构，是用一组`连续的内存空间`，来存储一组具有`相同数据类型`的数据。几乎在所有的编程语言都存在数组这中最基本的数据结构类型。在 Objective-C 语言中是 `NSArray`，当然 Objective-C 是 C 的超集，所以也完全可以使用 C 语言的数组类型。

![](http://liangjinggege.com/array.jpg)

### 随机访问

正式因为数组是用一组`连续的内存空间`来存储数据的，所以数组支持`下标随机访问`，复杂度是 `O(1)`。

```C

int[] a = new int[10]

// 数组a 首地址
base_address = 1000

// 寻址公式 data_type_size：数组中元素的数据类型长度
a[i]_address = base_address + i * data_type_size
```

### 插入和删除

相比于复杂度是 `O(1)`的随机访问操作，对于数组而言，`插入和删除`操作的复杂度都为`O(n)`，因为每次要在数组的第 k 个位置插入或者删除一个元素的话，都需要移动 k ~ n 个元素的位置。

>**优化技巧：**

>插入操作：如果不需要追求数组中元素的`有序`，则可以考虑直接将第 k 个位置的元素移到数组的末尾，然后把要插入的新元素放到第 k 个位置就行，这样，复杂度也就是O(1)。
>删除操作：在一些场景下，并不追求数组中数据的连续性，可以将`多次删除操作集中在一起执行`。先记录下已经删除的元素，并不真的删除，当数组没有更多空间时，再触发真正的删除操作，这样可以省下大量重复的数据移动操作。


### 警惕数组越界问题

看一段 C 语言代码：

```	C
int main(int argc, char* argv[]){
    int i = 0;
    int arr[3] = {0};
    for(; i<=3; i++){
        arr[i] = 0;
        printf("hello world\n");
    }
    return 0;
}
```

这里就会出现`数组越界问题`，C语言的执行结果是`未决`，就是没有规定数组访问越界时编译器应该如何处理。如果该内存是一块`可以访问的不受限内存`，在x86架构机器下，那么执行结果是会无线循环打印hello world。原因是内存分配从栈的`高位到低位`开始，i 变量实际上与数组元素 arr[2] 相邻。数组下标从 0 开始，当执行到循环最后一次 i = 3 时，根据根据之前的寻址公式 `a[i]_address = base_address + i * data_type_size`，实际上 arr[3] 访问的会是变量 i 的地址，赋值给 i = 0，然后死循环。

>这里还和使用的编译器`内存分配以及字节对齐`有关系，有些编译器会默认开启`堆栈保护`，当如果变量访问一块不属于自己的内存时，会出现编译错误。
>为了不让程序出现这种不确定的错误，导致 debug 难度大，还有就是容易被黑客利用攻击，所以写代码时要特别`警惕数组越界`。不过很多高级语言的都会默认做`越界检查`，如 Objective-C 里面的数组，如果越界访问就会下面这种经典错误。

![](http://liangjinggege.com/Xnip2019-03-07_14-30-42.png)

### 怎么选择容器还是数组？

#### 容器优点

1. 将很多数组插入删除等操作细节封装起来，提供很多易用的API。
2. `动态扩容`，如果插入数据的时候发现数组的空间不够，就需要重新申请一块更大的内存空间，并把原来的数据都复制进新的数组，在将新的数据插入。但是如果事先知道数据的大小，可以创建的时候就制定好数据的大小，这样可以避免不必要的`动态扩容`操作。


#### 数组优点

1. 存储基本数据类型。
2. 当数组大小事先已知，并且数据操作比较简单。

#### 总结
日常业务开发，使用高级语言提供的数组容器就行，如 Objective-C 的 `NSArray`，损失一点性能，但写起来方便简单。如果是做比较注重性能的底层开发，可以考虑使用数组。

### 数组的下标为什么从 0 开始？

1. 寻址算法，如果下标不从 0 开始，从 1 开始会怎样，寻址算法就变成 `a[i]_address = base_address + （i - 1 * data_type_size）`，转成汇编指令，对于 CPU 而言，就多了一条要执行的`减法指令`，而这种数组的操作是很频繁很底层的操作，为了优化，所以数组的下标都设计从 0 开始。
2. 历史原因，由于 C 语言是后面很多语言设计的参考，为了保持程序员的编码习惯，所以后面的程序语言设计者也保持和 C 语言数组一样的风格。

## 课后思考题

1. 前面我基于数组的原理引出 JVM 的标记清除垃圾回收算法的核心理念，我不知道你是否使用 Java 语言，理解 JVM，如果你熟悉回顾下你理解的标记清除垃圾回收算法。

	- **解答：** 不熟悉 Java 语言。

2. 前面我们讲到一维数组的内存寻址公式，那你可以思考一下，类比一二维数组的寻址公式是怎样？

	- **解答：** m * n 数组，`a[i][j]_address = base_address + （i * n + j data_type_size）`，其中 i < m，j < n。内存布局如下：

	![](http://liangjinggege.com/Xnip2019-03-07_15-15-04.png?imageView2/2/w/400)
	
***

分享个人技术学习记录和跑步马拉松训练比赛、读书笔记等内容，感兴趣的朋友可以关注我的公众号「青争哥哥」。

![](http://liangjinggege.com/qrcode_for_gh_0be790c1f754_258.jpg)